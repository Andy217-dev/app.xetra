"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4360],{64360:function(e,t,s){s.r(t),s.d(t,{default:function(){return k}});var r=s(57437),a=s(89733),l=s(4919),n=s(44355),i=s(60469),c={src:"/_next/static/media/ai.3f109401.gif",height:640,width:640,blurWidth:0,blurHeight:0},o=s(85270),d=s(44398),h=s(13035),x=s(82031),u=s(81724),m=s(66648),p=s(2265),g=s(26735),f={src:"/_next/static/media/dots3.d21dfb6c.svg",height:20,width:20,blurWidth:0,blurHeight:0},b={src:"/_next/static/media/bin.c880959d.svg",height:20,width:20,blurWidth:0,blurHeight:0};let v=()=>(0,r.jsxs)("div",{className:"py-2 px-3 rounded-lg animate-pulse",children:[(0,r.jsxs)("div",{className:"w-full items-center flex justify-between",children:[(0,r.jsx)("div",{className:"h-5 bg-gray-200 rounded w-3/4"}),(0,r.jsx)("div",{className:"h-5 w-5 bg-gray-200 rounded"})]}),(0,r.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/2 mt-2"})]}),j=e=>{let{conversation:t,isActive:s,onSelect:a,openDropdownId:l,onDotsClick:n,dropdownRef:i}=e;return(0,r.jsxs)("div",{onClick:()=>a(t.id),className:"py-2 px-3 rounded-lg cursor-pointer hover:bg-gray-100 ".concat(s?"bg-[#EAEAEA]":""),children:[(0,r.jsxs)("div",{className:"w-full items-center flex justify-between",children:[(0,r.jsx)("h3",{className:"text-sm font-semibold truncate",children:t.title}),(0,r.jsxs)("div",{ref:i,className:"relative",children:[(0,r.jsx)("button",{onClick:e=>n(e,t.id),children:(0,r.jsx)(m.default,{src:f,alt:"dots",width:20,height:20,className:"hover:opacity-70"})}),l===t.id&&(0,r.jsx)("div",{className:"absolute right-0 mt-0 w-[120px] bg-white rounded-md shadow-lg z-50 border border-[#EAEAEA]",children:(0,r.jsxs)("button",{onClick:e=>{e.stopPropagation()},className:"w-full px-3 py-2 text-xs font-semibold line-clamp-1 text-nowrap text-[#FB3748] hover:bg-gray-100 flex items-center gap-2 rounded-md",children:[(0,r.jsx)(m.default,{src:b,alt:"bin",width:20,height:20}),"Delete Chat"]})})]})]}),t.messages[0]&&(0,r.jsx)("p",{className:"text-xs text-gray-500 truncate",children:t.messages[0].content})]})};function w(e){let{onStartNewChat:t}=e;return(0,r.jsx)("div",{className:"flex flex-col items-center justify-center h-full text-center px-4",children:(0,r.jsxs)("div",{className:"max-w-md space-y-4",children:[(0,r.jsx)("h3",{className:"text-xl font-semibold text-gray-800",children:"No chat selected"}),(0,r.jsx)("p",{className:"text-gray-600",children:"Start a new chat or select a previous conversation to begin"}),(0,r.jsx)(a.z,{onClick:t,className:"bg-[linear-gradient(96deg,#FFDBAD_9.5%,#FF306E_98.71%)]",children:"Start New Chat"})]})})}var N=s(12266);let y=e=>{var t,s,a;let{token:l}=e;return(0,r.jsxs)("div",{className:"bg-white rounded-lg shadow p-4 flex flex-col",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[l.icon&&(0,r.jsx)("img",{src:l.icon,alt:l.name,className:"w-8 h-8 rounded-full",onError:e=>{e.currentTarget.src="/api/placeholder/32/32"}}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-bold",children:l.symbol}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:l.name}),l.website&&(0,r.jsx)("a",{href:l.website,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-blue-500 hover:text-blue-700",children:"Website ↗"})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-600",children:"Price"}),(0,r.jsx)("p",{className:"font-medium",children:l.price})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-600",children:"24h Change"}),(0,r.jsx)("p",{className:parseFloat(l.change24h)>=0?"text-green-600":"text-red-600",children:l.change24h})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-600",children:"Volume 24h"}),(0,r.jsx)("p",{className:"font-medium",children:l.volume24h})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-600",children:"Liquidity"}),(0,r.jsx)("p",{className:"font-medium",children:l.liquidity})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-600",children:"Market Cap"}),(0,r.jsx)("p",{className:"font-medium",children:l.marketCap})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-gray-600",children:"24h Txns"}),(0,r.jsx)("p",{className:"font-medium",children:l.txnCount24h})]})]}),(null!==(s=null===(t=l.labels)||void 0===t?void 0:t.length)&&void 0!==s?s:0)>0&&(0,r.jsx)("div",{className:"mt-2 flex flex-wrap gap-1",children:(null!==(a=l.labels)&&void 0!==a?a:[]).map((e,t)=>(0,r.jsx)("span",{className:"px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded-full",children:e},t))})]})};var E=e=>{let{content:t,role:s,createdAt:a}=e;console.log("content",t);let l=(e=>{let t=[],s=0;return e.split(/(\[VIEW:token-grid\][\s\S]*?\[\/VIEW:token-grid\])/).forEach(e=>{if(e.trim()){if(e.startsWith("[VIEW:token-grid]"))try{let r=e.match(/\[VIEW:token-grid\]([\s\S]*?)\[\/VIEW:token-grid\]/);r&&t.push({type:"token-grid",content:JSON.parse(r[1]),order:s})}catch(e){console.error("Grid parse error:",e)}else t.push({type:"markdown",content:(0,N.TU)(e),order:s});s+=e.length}}),t.sort((e,t)=>e.order-t.order)})(t);return(0,r.jsx)("div",{className:"flex ".concat("user"===s?"justify-end":"justify-start"),children:(0,r.jsxs)("div",{className:"max-w-[80%] rounded-[20px] py-3 px-4 ".concat("user"===s?"bg-[rgba(255,48,110,0.16)]":"bg-white shadow"),children:[l.map((e,t)=>(0,r.jsx)("div",{className:"",children:"token-grid"===e.type?(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:e.content.tokens.map((e,t)=>(0,r.jsx)(y,{token:e},"".concat(e.symbol,"-").concat(t)))}):(0,r.jsx)("div",{className:" break-words prose prose-sm max-w-none prose-headings:mt-2 prose-headings:mb-1  prose-p:my-1  prose-ul:my-1 prose-ul:pl-4  prose-li:my-0 prose-strong:font-semibold",dangerouslySetInnerHTML:{__html:e.content}})},t)),(0,r.jsx)("div",{className:"text-xs mt-2 ".concat("user"===s?"text-white/70":"text-gray-400")})]})})};function k(){let[e,t]=(0,p.useState)([]),[s,f]=(0,p.useState)([]),[b,N]=(0,p.useState)(null),[y,k]=(0,p.useState)(""),[_,S]=(0,p.useState)(!1),[C,A]=(0,p.useState)(!0),D=(0,p.useRef)(null),W=(0,p.useRef)(null),{address:F}=(0,g.m)(),[I,z]=(0,p.useState)(null),Z=(0,p.useRef)(null),[B,H]=(0,p.useState)(!1),T=[{value:"What's the price of Ethereum?",icon:d.Z},{value:"What's trending on Ethereum?",icon:o.Z},{value:"What's the current native token balance of my wallet?",icon:o.Z},{value:"Top gainers in the last 24h",icon:o.Z},{value:"What's the price of Ethereum in the last 24 hours?",icon:h.Z}],V=(e,t)=>{e.stopPropagation(),z(I===t?null:t)};(0,p.useEffect)(()=>{var e;null===(e=D.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[e]),(0,p.useEffect)(()=>{F&&O()},[F]),(0,p.useEffect)(()=>()=>{W.current&&W.current.close()},[]),(0,p.useEffect)(()=>{let e=e=>{Z.current&&!Z.current.contains(e.target)&&z(null)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]);let O=async()=>{if(F)try{let e=await fetch("https://be-nestjs-web3-ai-agent-production.up.railway.app/ai/conversations/".concat(F)),t=await e.json();f(t),console.log("conversations are ",t)}catch(e){console.error("Error fetching conversations:",e)}},R=async e=>{try{let s=await fetch("https://be-nestjs-web3-ai-agent-production.up.railway.app/ai/messages/".concat(e)),r=await s.json();t(r)}catch(e){console.error("Error fetching messages:",e)}},P=async()=>{if(F)try{H(!0);let e=await fetch("https://be-nestjs-web3-ai-agent-production.up.railway.app/ai/conversation",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:F})}),s=await e.json();return N(s.id),t([]),await O(),(0,u.R)("success","New chat started successfully"),H(!1),s.id}catch(e){return console.error("Error starting conversation:",e),(0,u.R)("error","Error starting new chat"),null}},L=e=>{2===e?k(T[e].value+" "+F):k(T[e].value)},M=async e=>{if(e.preventDefault(),!y.trim()||_||!b||!F)return;let s=y.trim();k(""),S(!0),W.current&&W.current.close();let r={id:Date.now().toString(),role:"user",content:s,createdAt:new Date().toISOString()};t(e=>e.length>0?[...e,r]:[r]);try{let e=new URL("https://be-nestjs-web3-ai-agent-production.up.railway.app/ai/chat");e.searchParams.append("message",s),e.searchParams.append("conversationId",b),W.current=new EventSource(e.toString());let r="";W.current.onmessage=e=>{try{let a=e.data;if("[DONE]"===a){var s;S(!1),null===(s=W.current)||void 0===s||s.close(),O();return}r+=a,t(e=>{let t=[...e],s=t[t.length-1];return s&&"assistant"===s.role?(s.content=r,[...t]):[...t,{id:Date.now().toString(),role:"assistant",content:r,createdAt:new Date().toISOString()}]})}catch(e){console.error("Error processing message chunk:",e)}},W.current.onerror=e=>{var s;console.error("SSE Error:",e),S(!1),null===(s=W.current)||void 0===s||s.close(),r||t(e=>[...e,{id:Date.now().toString(),role:"assistant",content:"Sorry, there was an error processing your message.",createdAt:new Date().toISOString()}])}}catch(e){console.error("Chat error:",e),S(!1)}};return(0,r.jsxs)("div",{className:"flex md:h-full h-[calc(100%_-_80px)] relative",children:[(0,r.jsxs)("div",{className:"".concat(C?"md:w-64 w-full h-full z-10":"w-0"," bg-white transition-all duration-300 overflow-hidden flex md:relative absolute flex-col border-r border-gray-200"),children:[(0,r.jsxs)("div",{className:"flex justify-between items-end",children:[(0,r.jsx)("h1",{className:"text-[#1B1B1B] text-2xl font-semibold pt-8 px-3 md:text-center text-start",children:"Chat with Xetra AI"}),(0,r.jsx)("button",{onClick:()=>A(!C),className:"md:hidden text-2xl text-[#1B1B1B] px-4 py-2 border border-[#EAEAEA] rounded-lg mr-4",children:"☰"})]}),(0,r.jsx)("div",{className:"p-4 md:flex hidden",children:(0,r.jsx)(a.z,{onClick:P,disabled:B,className:"w-full bg-[linear-gradient(96deg,#FFDBAD_9.5%,#FF306E_98.71%)] ".concat(B?"opacity-50 cursor-not-allowed":""),children:"+ New Chat"})}),(0,r.jsx)("button",{onClick:P,className:"md:hidden flex bg-[linear-gradient(148deg,#FFDBAD_5.17%,#FF306E_87.8%)] absolute top-[85%] right-4 z-20 text-white text-2xl justify-center items-center h-14 w-14 rounded-full shadow-[0px_13px_8px_0px_rgba(211,130,152,0.22),0px_6px_6px_0px_rgba(211,130,152,0.38),0px_1px_3px_0px_rgba(211,130,152,0.44)]",children:"+"}),(0,r.jsx)("div",{className:"flex-1 overflow-y-auto px-3 md:mt-0 mt-4 relative",children:(0,r.jsx)("div",{className:"flex-1 overflow-y-auto",children:(0,r.jsxs)("div",{className:"flex-1 overflow-y-auto",children:[B&&(0,r.jsx)(v,{}),[...s].reverse().map(e=>(0,r.jsx)(j,{conversation:e,isActive:b===e.id,onSelect:e=>{N(e),R(e)},openDropdownId:I,onDotsClick:V,dropdownRef:Z},e.id))]})})})]}),(0,r.jsxs)("div",{className:"flex-1 flex flex-col h-full z-0",children:[(0,r.jsxs)("div",{className:"sticky top-0 z-10 md:flex px-4 md:px-10 space-y-4 w-full justify-between bg-transparent py-4",children:[(0,r.jsx)("div",{className:"flex items-center gap-4",children:(0,r.jsxs)("div",{onClick:()=>A(!C),className:"font-inter text-2xl font-semibold text-[#1b1b1b] flex items-center gap-4",children:[(0,r.jsx)("div",{className:"p-1 rounded-2xl border border-[#EAEAEA] bg-white",children:(0,r.jsx)(m.default,{src:c,alt:"gif",width:40,height:40})}),(0,r.jsx)("span",{children:"Xetra AI"})]})}),(0,r.jsx)("div",{className:"flex items-center gap-4",children:(0,r.jsx)(n.Z,{})})]}),b?(0,r.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:["object"==typeof e&&e.length>0&&(null==e?void 0:e.map(e=>(0,r.jsx)(E,{content:e.content,role:e.role,createdAt:e.createdAt},e.id))),_&&(0,r.jsxs)("div",{className:"flex items-center justify-start gap-3",children:[(0,r.jsx)(m.default,{className:"rounded-full",src:c,alt:"Assistant",width:48,height:48}),(0,r.jsx)("div",{className:"flex items-center gap-2 bg-white shadow rounded-[20px] px-4 py-2",children:(0,r.jsx)(m.default,{unoptimized:!0,src:i.Z,alt:"loading",height:24})})]}),(0,r.jsx)("div",{ref:D})]}):(0,r.jsx)(w,{onStartNewChat:P}),(0,r.jsx)("div",{className:"w-full",children:b&&(0,r.jsxs)("div",{className:"w-screen md:w-full",children:[(0,r.jsx)("div",{className:"flex justify-center md:mb-0 mb-2 w-[calc(100%-32px)] md:w-[calc(100%-80px)] md:px-8 px-4",children:(0,r.jsx)("div",{className:"flex w-full overflow-x-auto no-scrollbar md:flex-wrap gap-4",children:T.map((e,t)=>(0,r.jsxs)(a.z,{variant:"outline",className:"h-11 max-w-max rounded-lg border border-[#eaeaea] bg-white p-3",onClick:()=>L(t),children:[(0,r.jsx)(m.default,{src:e.icon,alt:"suggestion",className:"text-black",width:20}),(0,r.jsx)("p",{className:"font-inter text-xs font-medium leading-none text-[#1b1b1b]",children:e.value})]},t))})}),(0,r.jsx)("div",{className:"p-4 md:p-8",children:(0,r.jsx)("div",{className:"w-full rounded-3xl p-0.5 ".concat(b?"":"opacity-50"),style:{background:"linear-gradient(to right, #6767FF, #F06DFF)"},children:(0,r.jsxs)("div",{className:"relative rounded-[22px] bg-white",children:[(0,r.jsx)(l.g,{placeholder:b?"Type your message here...":"Select or start a chat to begin messaging",className:"min-h-[100px] resize-none border-none bg-transparent p-4 font-inter text-base",value:y,onChange:e=>k(e.target.value),disabled:!b,onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),M(e))}}),(0,r.jsx)(a.z,{size:"icon",className:"absolute bottom-4 right-4 rounded-full",onClick:M,disabled:!F||_||!b,children:_?(0,r.jsxs)("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[(0,r.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,r.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"})]}):(0,r.jsx)(m.default,{src:x.Z,alt:"send",width:24,height:24})})]})})})]})})]})]})}},60469:function(e,t){t.Z={src:"/_next/static/media/loading-message.56fab996.gif",height:250,width:500,blurWidth:0,blurHeight:0}},85270:function(e,t){t.Z={src:"/_next/static/media/dapp.ed246641.svg",height:20,width:20,blurWidth:0,blurHeight:0}},44398:function(e,t){t.Z={src:"/_next/static/media/eth.0f38c48b.svg",height:20,width:20,blurWidth:0,blurHeight:0}},13035:function(e,t){t.Z={src:"/_next/static/media/image.c63fb385.svg",height:20,width:20,blurWidth:0,blurHeight:0}},82031:function(e,t){t.Z={src:"/_next/static/media/send.b8771b7b.svg",height:24,width:24,blurWidth:0,blurHeight:0}}}]);